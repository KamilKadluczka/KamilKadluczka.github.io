<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Charts.js</title>
    <!-- 
        Bootstrap
    -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <!-- 
        Chart.js
    -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    
    <!--
        This creates a div, in which there is a bootstrap row div, inside of which are two(2) bootstrap col divs.
        All that with some styling to make this sheet look presentable.
    -->
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8" style="height: 318px;">
                <canvas id="First_Chart_id"></canvas>
            </div>
            <div class="col-md-4" style="height: 318px;">
                <canvas id="Second_Chart_id"></canvas>
            </div>
        </div>
    </div>


    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

    <!-- Chart.js -->
    <script>
// ------------------------------------------ Using fetch() to get the data from the JSON file ------------------------------------------ //
        //
        // We need to put all charts into this ".then(jsonData => {" thing for them to work.
        // Probably a scope (read as: skill) issue.
        //
        // Note: JSON file needs to be named EXACTLY like below, no matter what yo mama tells you
        fetch('some_schematic.json')
            .then(response => response.json())
            .then(jsonData => {
                // This creates all STOCK variables
                let TV_stock = 0;
                let sluchawki_stock = 0;
                let laptop_stock = 0;
                let tablet_stock = 0;
                let smartfon_stock = 0;
                let aparat_stock = 0;

                // This creates all LOOKUPS variables
                let TV_lookups = 0;
                let sluchawki_lookups = 0;
                let laptop_lookups = 0;
                let tablet_lookups = 0;
                let smartfon_lookups = 0;
                let aparat_lookups = 0;

                // AND THIS... made me cry xD
                // Fo real tho,
                // This iterates through each object in the JSON data
                jsonData.forEach(item => {
                // This checks if the category is "TV"
                if (item.category === 'TV') {
                    // If so, then it adds the "q_in_stock" value to "TV_stock" variable
                    TV_stock += item.q_in_stock;
                // If there are no matches, it checks whether the "category" matches any of the listed below
                } else if (item.category === 'Słuchawki') {
                    sluchawki_stock += item.q_in_stock;
                } else if (item.category === 'Laptop') {
                    laptop_stock += item.q_in_stock;
                } else if (item.category === 'Tablet') {
                    tablet_stock += item.q_in_stock;
                } else if (item.category === 'Smartfon') {
                    smartfon_stock += item.q_in_stock;
                } else if (item.category === 'Aparat') {
                    aparat_stock += item.q_in_stock;
                };
                // Same s***, except for lookup variables
                if (item.category === 'TV') {
                    TV_lookups += item.lookups;
                } else if (item.category === 'Słuchawki') {
                    sluchawki_lookups += item.lookups;
                } else if (item.category === 'Laptop') {
                    laptop_lookups += item.lookups;
                } else if (item.category === 'Tablet') {
                    tablet_lookups += item.lookups;
                } else if (item.category === 'Smartfon') {
                    smartfon_lookups += item.lookups;
                } else if (item.category === 'Aparat') {
                    aparat_lookups += item.lookups;
                };
                });

                // Output to browser console for testing 
                console.log('Total TV Stock:', TV_stock);
                console.log('Total Słuchawki Stock:', sluchawki_stock);
                console.log('Total Laptop Stock:', laptop_stock);
                console.log('Total Tablet Stock:', tablet_stock);
                console.log('Total Smartfon Stock:', smartfon_stock);
                console.log('Total Aparat Stock:', aparat_stock);
                console.log() // Chill, it's for readability. TRUST ME
                console.log('Total TV lookups:', TV_lookups);
                console.log('Total Słuchawki lookups:', sluchawki_lookups);
                console.log('Total Laptop lookups:', laptop_lookups);
                console.log('Total Tablet lookups:', tablet_lookups);
                console.log('Total Smartfon lookups:', smartfon_lookups);
                console.log('Total Aparat lookups:', aparat_lookups);

//-------------------------------------------------------- FIRST CHART BELOW HERE --------------------------------------------------------//
                // Staging Area for the chart
                // We need Data, and Options
                // So we create both variables as listed

                // Data
                var barChartData = {
                    labels: ['TV', 'Słuchawki', 'Laptop', 'Tablet', 'Smartfon', 'Aparat'],
                    datasets: [{
                        label: "Lookups",
                        // These need to be numbers, and since we have variables WITH said numbers, we put them here
                        data: [TV_lookups, sluchawki_lookups, laptop_lookups, tablet_lookups, smartfon_lookups, aparat_lookups],
                        backgroundColor: [
                                        '#ffa1b5',
                                        '#c2a3ff',
                                        '#86c7f3',
                                        '#93d9d9',
                                        '#ffe29a',
                                        '#ffc58c',
                                        ],
                    },]
                };

                // Options
                var barChartOptions = {
                    // Scales are something like a background graph
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                };

                // This creates the damned thing
                // Here, we need context variable, which we get here
                var barChartCtx = document.getElementById("First_Chart_id").getContext('2d');
                // And this creates the actual chart (hopefully)
                var barChart = new Chart(barChartCtx, {
                    type: 'bar', // This can be 'bar', 'bubble', 'doughnut', 'pie', 'line' etc.
                    data: barChartData, // Data is here
                    options: barChartOptions // Options are here
                });
//-------------------------------------------------------- FIRST CHART ABOVE HERE --------------------------------------------------------//
//-------------------------------------------------------- SECOND CHART BELOW HERE -------------------------------------------------------//
                // Staging Area again
                // Data
                var barChartData = {
                    labels: ['TV', 'Słuchawki', 'Laptop', 'Tablet', 'Smartfon', 'Aparat'],
                    datasets: [{
                        label: 'Doughnut Chart text',
                        data: [TV_stock, sluchawki_stock, laptop_stock, tablet_stock, smartfon_stock, aparat_stock],
                        backgroundColor: [
                                        '#ffa1b5',
                                        '#c2a3ff',
                                        '#86c7f3',
                                        '#93d9d9',
                                        '#ffe29a',
                                        '#ffc58c',
                                        ],
                    }]
                };

                // Options
                var barChartOptions = {
                    // DON'T EVEN TOUCH THIS
                    // pls
                };

                // Create the abomination
                var barCtx = document.getElementById("Second_Chart_id").getContext('2d');
                var barChart = new Chart(barCtx, {
                    type: 'doughnut',
                    data: barChartData,
                    options: barChartOptions
                });
            })
            .catch(error => console.error('Error fetching data:', error));
//-------------------------------------------------------- SECOND CHART ABOVE HERE -------------------------------------------------------//
        // The fetch() itself, ends on this tab here
    </script>
  </body>
</html>
